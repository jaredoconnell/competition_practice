Took 28 minutes to complete problem. Most of the time was spent debugging a stupid oversight.